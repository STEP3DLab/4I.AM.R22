import React from 'react';

// STEP_3D — Telegram Mini-App
// Single-file design spec & prototype mockup for a Telegram WebApp (Mini App)
// Uses Tailwind-like classes in markup for easy conversion. This file is a design-document
// presented as a React component so it can be previewed in canvas and exported.

export default function Step3dTelegramMiniAppDesign() {
  return (
    <div className="p-8 max-w-4xl mx-auto font-sans text-slate-800">
      <h1 className="text-3xl font-bold">STEP_3D — Mini App (Telegram Web App) — Дизайн‑проект</h1>
      <p className="mt-3 text-slate-600">Цель: удобное мобильное mini‑приложение внутри Telegram для приёма заказов на 3D‑печать, управления заданиями хостов (школ/колледжей) и мониторинга статуса печати.</p>

      <hr className="my-6" />

      <h2 className="text-2xl font-semibold">1. Ключевые сценарии (User Journeys)</h2>
      <ol className="mt-3 space-y-2 list-decimal list-inside text-slate-700">
        <li><b>Клиент:</b> загрузить STL → выбрать материал и параметры → увидеть мгновенную оценку → оплатить → отслеживать статус → получить трек‑номер.</li>
        <li><b>Школа/колледж (хост):</b> получать задания → принять/отклонировать → печать → фотофиксация и загрузка фото → отметить как готово → запрос на отгрузку.</li>
        <li><b>Оператор STEP_3D:</b> мониторить очередь, переназначать задания, обрабатывать рекламации и отчёты по качеству.</li>
      </ol>

      <h2 className="text-2xl font-semibold mt-6">2. Структура и навигация</h2>
      <p className="mt-2 text-slate-700">Мини-приложение делится на 4 вкладки (нижняя навигация):</p>
      <ul className="mt-3 list-disc list-inside">
        <li><b>Заказать</b> — загрузка STL, автоматическая оценка, варианты материалов, быстрый заказ.</li>
        <li><b>Мои заказы</b> — история, статусы, чаты с хостом и саппортом, трек‑номер.</li>
        <li><b>Партнёрам</b> — панель хоста: входящие задания, инструкции, чек‑листы, отчётность.</li>
        <li><b>Профиль</b> — настройки, платёжные методы, юридические документы, обучение.</li>
      </ul>

      <h2 className="text-2xl font-semibold mt-6">3. Главный экран — «Заказать» (Wireframe)</h2>
      <div className="mt-3 border rounded-lg p-4 bg-white shadow-sm">
        <div className="text-sm text-slate-600">Компоненты:</div>
        <ul className="mt-2 list-disc list-inside">
          <li><b>1.</b> Баннер: CTA «Загрузить STL»</li>
          <li><b>2.</b> Карточка автооценки: превью, объём (см³), время, цена</li>
          <li><b>3.</b> Селектор материала: PLA / PETG / Resin / SLA</li>
          <li><b>4.</b> Опции: качество слоя, заполнение, поддержка</li>
          <li><b>5.</b> Кнопка «Оформить заказ» → встроенная оплата через Telegram Payments</li>
        </ul>
      </div>

      <h2 className="text-2xl font-semibold mt-6">4. Экран хоста (школа)</h2>
      <p className="mt-2 text-slate-700">Панель хоста — упрощённая, сфокусирована на задачах:</p>
      <ul className="mt-2 list-disc list-inside">
        <li>Список входящих заданий (приоритет, материал, ориентировочное время)</li>
        <li>Кнопки: «Принять», «Отклонить», «Переназначить»</li>
        <li>Инструкция по профилю печати (pre-set) и чек‑лист</li>
        <li>Загрузка фото перед упаковкой + поле для комментариев</li>
      </ul>

      <h2 className="text-2xl font-semibold mt-6">5. Встроенные диалоги и уведомления</h2>
      <p className="mt-2 text-slate-700">Мини-приложение должно использовать возможности Telegram: встроенный WebApp.button, бота для уведомлений и чат‑интеграцию.</p>
      <ul className="mt-2 list-disc list-inside">
        <li>Push‑уведомления в Telegram (bot): заказ принят, печать начата, печать завершена, отправлено.</li>
        <li>Встроенный chat-with-host: быстрый шаблон сообщений (вопросы по качеству / сроки).</li>
        <li>Интерактивные клавиши: «Принять», «Отклонить», «Запросить фото».</li>
      </ul>

      <h2 className="text-2xl font-semibold mt-6">6. Визуальная айдентика и UI-палитра</h2>
      <p className="mt-2 text-slate-700">Рекомендуемая палитра (современная, технологичная):</p>
      <div className="mt-3 flex gap-3 items-center">
        <div className="w-12 h-12 rounded bg-indigo-600 flex items-center justify-center text-white font-bold">#1</div>
        <div className="w-12 h-12 rounded bg-cyan-400"></div>
        <div className="w-12 h-12 rounded bg-slate-900"></div>
        <div className="w-12 h-12 rounded bg-white border"></div>
      </div>
      <p className="mt-3 text-sm text-slate-600">Шрифты: Inter / Roboto. Иконки: lucide / feather. Кнопки — большие, округлые, контрастные для тача.</p>

      <h2 className="text-2xl font-semibold mt-6">7. Техническая архитектура (кратко)</h2>
      <ol className="list-decimal list-inside">
        <li><b>Frontend:</b> Telegram Web App (React + Tailwind), адаптивный для iOS/Android.</li>
        <li><b>Bot:</b> Telegram Bot API — уведомления, прием платежей, fallback команды.</li>
        <li><b>Backend:</b> REST API (Node.js/Express или Python FastAPI) — endpoints ниже.</li>
        <li><b>AI/Оценка:</b> STEP_3D_System – microservice: auto-cost + slicing heuristics.</li>
        <li><b>DB:</b> PostgreSQL (orders, users, hosts), Redis (очереди), S3 (файлы STL, фото).</li>
        <li><b>Интеграции:</b> Ozon/SDEK API (логистика), Telegram Payments / SBP для платежей.</li>
      </ol>

      <h3 className="mt-4 font-semibold">Ключевые API endpoints (пример)</h3>
      <pre className="bg-slate-50 p-3 rounded">
POST /api/orders/upload-stl  – загружает STL, возвращает оценку
POST /api/orders/create      – создаёт заказ (userId, stlId, material, options)
GET  /api/orders/:id/status  – статус заказа
POST /api/hosts/:id/accept    – хост принимает заказ
POST /api/hosts/:id/finish    – хост отмечает как готово + фото
POST /api/integrations/ship  – создаёт отправление у логиста
GET  /api/analytics/usage     – агрегированные метрики
      </pre>

      <h2 className="text-2xl font-semibold mt-6">8. Data model (упрощённо)</h2>
      <pre className="bg-slate-50 p-3 rounded">
User { id, telegram_id, name, role(client|host|admin), balance }
Order { id, user_id, stl_id, host_id, material, options, volume_cm3, price, status }
STLFile { id, user_id, path, volume_cm3, preview_url }
Host { id, name, location, rating, active_printers }
HostPrinter { id, host_id, model, status }
      </pre>

      <h2 className="text-2xl font-semibold mt-6">9. Платежи и расчёты</h2>
      <p className="text-slate-700">Рекомендуемые потоки:</p>
      <ul className="list-disc list-inside">
        <li>Оплата через Telegram Payments / Stripe / SberPay. Платёж резервируется, затем распределяется: хосту — по факту выполнения, платформа — комиссия.</li>
        <li>Для партнёров (школ): еженедельные или ежемесячные выплаты через банк + отчётность.</li>
      </ul>

      <h2 className="text-2xl font-semibold mt-6">10. UX‑правила и ограничения</h2>
      <ul className="list-disc list-inside">
        <li>Максимум 3 шага до оплаты для repeat‑пользователя.</li>
        <li>Обязательная автооценка в 1–3 секунды (показывать placeholder если долго).</li>
        <li>Фотофиксация обязательна для хостов перед упаковкой — минимизирует споры.</li>
        <li>Отключать печать опасных/запрещённых объектов через фильтр ключевых слов + manual check.</li>
      </ul>

      <h2 className="text-2xl font-semibold mt-6">11. Метрики и аналитика</h2>
      <p className="text-slate-700">Отслеживать в real-time:</p>
      <ul className="list-disc list-inside">
        <li>Количество загрузок STL / conversion rate → заказ</li>
        <li>Средний чек, GMV, % повторных клиентов</li>
        <li>Время от заказа до старта печати</li>
        <li>Качество: % возвратов по хосту</li>
      </ul>

      <h2 className="text-2xl font-semibold mt-6">12. Accessibility & Security</h2>
      <ul className="list-disc list-inside">
        <li>Использовать HTTPS + CSP; проверка файлов STL на malware и size limits.</li>
        <li>Авторизация через Telegram (tg.user) + server-side verification.</li>
        <li>Хранение персональных данных в соответствии с российским законодательством.</li>
      </ul>

      <h2 className="text-2xl font-semibold mt-6">13. Прототипы экранов (описание)</h2>
      <p className="mt-2 text-slate-700">Готовлю 6 ключевых экранов как статические макеты (PNG) или интерактивный прототип:</p>
      <ol className="list-decimal list-inside">
        <li>Домашний (Заказать) — загрузка STL</li>
        <li>Auto‑estimate — карточка оценки и опции</li>
        <li>Checkout — оплата</li>
        <li>Order status — трекинг и чат</li>
        <li>Host dashboard — список заданий</li>
        <li>Profile & Docs — настройки и справка</li>
      </ol>

      <h2 className="text-2xl font-semibold mt-6">14. План разработки и приоритеты (MVP)</h2>
      <ol className="list-decimal list-inside">
        <li>Telegram WebApp skeleton + Telegram Bot (auth + notifications)</li>
        <li>Upload STL → auto-estimate (fast path) → checkout (payments)</li>
        <li>Host panel: accept/finish + photo upload</li>
        <li>Integrations: S3, PostgreSQL, basic analytics</li>
        <li>POC with 5 pilot schools, 10 own printers</li>
      </ol>

      <h2 className="text-2xl font-semibold mt-6">15. QA и Acceptance criteria</h2>
      <ul className="list-disc list-inside">
        <li>Upload latency &lt; 5s for 5MB STL (mobile networks)</li>
        <li>Auto-estimate accuracy &lt; ±20% vs manual estimate</li>
        <li>Payments success rate &gt; 98%</li>
        <li>Host acceptance flow — 95% of tasks processed within SLA window</li>
      </ul>

      <h2 className="text-2xl font-semibold mt-6">16. Next steps (предложение от меня)</h2>
      <ol className="list-decimal list-inside">
        <li>Подтвердите scope MVP — я подготовлю UI-макеты (6 экранов) в PNG + интерактивный прототип.</li>
        <li>Подготовлю техническое ТЗ (API spec + DB schema) для dev‑команды.</li>
        <li>Соберу package для пилота: onboarding‑пак школ, шаблоны договоров и инструкций.</li>
      </ol>

      <div className="mt-6 text-sm text-slate-600">Автор: STEP_3D — дизайн и продукт. Если хотите — я могу сейчас сгенерировать визуальные макеты (PNG) для всех перечисленных экранов и подготовить assets для разработчиков.</div>
    </div>
  );
}
